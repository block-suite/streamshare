!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e){!function(){t.exports=this.wp.element}()},function(t,e){!function(){t.exports=this.wp.components}()},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){var r=n(11),o=n(2);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var r=n(12);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e){!function(){t.exports=this.wp.blockEditor}()},function(t){t.exports=JSON.parse('{"name":"sortabrilliant/stream-share","category":"embed","attributes":{"url":{"type":"string","default":""},"src":{"type":"string","default":""},"type":{"type":"string","default":""}}}')},function(t,e){!function(){t.exports=this.wp.blocks}()},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){"use strict";n.r(e);var r=n(3),o=n.n(r),c=n(4),i=n.n(c),l=n(5),a=n.n(l),s=n(6),u=n.n(s),p=n(2),f=n.n(p),b=n(7),h=n.n(b),m=n(0),d=[{type:"channel",regex:/^https?:\/\/www\.twitch.tv\/([^\/?]+)/i,src:"https://player.twitch.tv/?channel="},{type:"videos",regex:/^https?:\/\/www\.twitch.tv\/videos\/(\d+)/i,src:"https://player.twitch.tv/?video=v"},{type:"collection",regex:/^https?:\/\/www\.twitch.tv\/collections\/([^\/?]+)/i,src:"https://player.twitch.tv/?collection="},{type:"clip",regex:/^https?:\/\/www\.twitch.tv\/[^\/?]+\/clip\/([^\/?]+)/i,src:"https://clips.twitch.tv/embed?clip="}],y=function(t){return Object(m.createElement)("iframe",{src:t,title:"Embedded content from twitch.tv",width:"640",height:"360",frameBorder:"0",scrolling:"no",allowFullScreen:!0})},v=n(1),w={foreground:"#9147ff",src:Object(m.createElement)(v.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},Object(m.createElement)(v.Path,{d:"M391.17,103.47H352.54v109.7h38.63ZM285,103H246.37V212.75H285ZM120.83,0,24.31,91.42V420.58H140.14V512l96.53-91.42h77.25L487.69,256V0ZM449.07,237.75l-77.22,73.12H294.61l-67.6,64v-64H140.14V36.58H449.07Z"}))},O=function(t){function e(){var t;return o()(this,e),(t=a()(this,u()(e).apply(this,arguments))).hideOverlay=t.hideOverlay.bind(f()(t)),t.state={interactive:!1},t}return h()(e,t),i()(e,[{key:"hideOverlay",value:function(){this.setState({interactive:!0})}},{key:"render",value:function(){var t=this.props.src,e=this.state.interactive,n=y(t),r=Object(m.createElement)("div",{className:"wp-block-embed__wrapper"},Object(m.createElement)(v.SandBox,{html:Object(m.renderToString)(n),title:"Embedded content from twitch.tv",onFocus:this.hideOverlay}),!e&&Object(m.createElement)("div",{className:"block-library-embed__interactive-overlay",onMouseUp:this.hideOverlay}));return Object(m.createElement)("figure",{className:"wp-block-embed-twitch wp-block-embed is-type-video"},r)}}],[{key:"getDerivedStateFromProps",value:function(t,e){return!t.isSelected&&e.interactive?{interactive:!1}:null}}]),e}(m.Component),g=n(8),j=function(t){var e=t.showEditButton,n=t.switchBackToURLInput;return Object(m.createElement)(g.BlockControls,null,Object(m.createElement)(v.Toolbar,null,e&&Object(m.createElement)(v.IconButton,{className:"components-toolbar__control",label:"Edit URL",icon:"edit",onClick:n})))},x=function(t){var e=t.icon,n=t.label,r=t.value,o=t.onSubmit,c=t.onChange;return Object(m.createElement)(v.Placeholder,{icon:Object(m.createElement)(g.BlockIcon,{icon:e,showColors:!0}),label:n,className:"wp-block-embed",instructions:"Paste a link to the content you want to display on your site."},Object(m.createElement)("form",{onSubmit:o},Object(m.createElement)("input",{type:"url",value:r||"",className:"components-placeholder__input","aria-label":n,placeholder:"Enter URL to embed hereâ€¦",onChange:c}),Object(m.createElement)(v.Button,{isLarge:!0,type:"submit"},"Embed")),Object(m.createElement)("div",{className:"components-placeholder__learn-more"},Object(m.createElement)(v.ExternalLink,{href:"https://wordpress.org/support/article/embeds/"},"Learn more about embeds")))},E=function(t){function e(){var t;return o()(this,e),(t=a()(this,u()(e).apply(this,arguments))).setUrl=t.setUrl.bind(f()(t)),t.switchBackToURLInput=t.switchBackToURLInput.bind(f()(t)),t.state={editingURL:!1,url:t.props.attributes.url},t}return h()(e,t),i()(e,[{key:"setUrl",value:function(t){t&&t.preventDefault();var e=this.state.url,n=this.props.setAttributes,r=function(t){var e={type:null,src:null},n=!0,r=!1,o=void 0;try{for(var c,i=d[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var l=c.value,a=t.match(l.regex);null!==a&&void 0!==a[1]&&(e={type:l.type,src:"".concat(l.src).concat(a[1],"&autoplay=false")})}}catch(t){r=!0,o=t}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}if("videos"===e.type&&t.includes("?")){var s=t.split("?"),u=new URLSearchParams(s[1]);u.has("collection")&&(e={type:"collection",src:"https://player.twitch.tv/?collection=".concat(u.get("collection"),"&autoplay=false")})}return e}(e),o=r.src,c=r.type;this.setState({editingURL:!1}),n({url:e,src:o,type:c})}},{key:"switchBackToURLInput",value:function(){this.setState({editingURL:!0})}},{key:"render",value:function(){var t=this,e=this.state,n=e.url,r=e.editingURL,o=this.props.isSelected,c=this.props.attributes.src;return!c||r?Object(m.createElement)(x,{icon:w,label:"Twitch URL",onSubmit:this.setUrl,value:n,onChange:function(e){return t.setState({url:e.target.value})}}):Object(m.createElement)(m.Fragment,null,Object(m.createElement)(j,{showEditButton:c,switchBackToURLInput:this.switchBackToURLInput}),Object(m.createElement)(O,{src:c,url:n,isSelected:o,icon:w,label:"Twitch URL"}))}}]),e}(m.Component),k=function(t){var e=t.attributes.src;if(!e)return null;var n=y(e);return Object(m.createElement)("figure",{className:"wp-block-embed-twitch wp-block-embed is-type-video"},Object(m.createElement)("div",{className:"wp-block-embed__wrapper"},n))},S=n(9),_=n(10),U=S.name,L=S.category,B=S.attributes;Object(_.registerBlockType)(U,{title:"Twitch",description:"Embed content from Twitch.",icon:w,keywords:["stream","video"],category:L,attributes:B,edit:E,save:k,example:{attributes:{src:"https://player.twitch.tv/?channel=backlogathon&autoplay=false"}},transforms:{from:[{type:"raw",isMatch:function(t){return"P"===t.nodeName&&/^\s*(https?:\/\/www\.twitch.tv\/\S+)\s*$/i.test(t.textContent)},transform:function(t){return Object(_.createBlock)(U,{url:t.textContent.trim()})}}]}})}]);